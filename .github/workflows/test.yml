name: "Test"

on:
  pull_request:
    types: [opened, synchronize, edited, reopened]

jobs:
  test-1:
    name: test-1
    runs-on: ubuntu-20.04
    steps:
      - name: Fail
        run: exit 1

  test-2:
    name: test-2
    runs-on: ubuntu-20.04
    steps:
      - name: Echo 
        run: echo "test-2"

  dep:
    name: dep
    needs: [test-1, test-2]
    runs-on: ubuntu-20.04
    steps:
      - name: Echo 
        run: echo "dep"

  notification: 
    name: notification
    if: failure()
    needs: [dep]
    runs-on: ubuntu-20.04
    steps:
      - name: Slack Failure Notification
        run: |
          curl -X POST -H 'Content-type: application/json' --data '{"text":" -> [ STATUS: ${{ job.status }} WORKFLOW_NAME: ${{ github.workflow }}  JOB: ${{ github.job }}  JOB_URL: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }} ] "}' ${{ secrets.SLACK_WEBHOOK }}